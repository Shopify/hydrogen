# yaml-language-server: $schema=../../recipe.schema.json

gid: 27d7e01b-7264-44e4-ae7c-32dc8da58c46
title: Custom cart method
summary: Add inline product option editing to cart items
description: |
  This recipe implements custom cart methods in Hydrogen using the Storefront API's
  `variantBySelectedOptions` query to let customers edit product options directly
  within the cart. They'll be able to change product variants (like size and color)
  without having to remove items, select different variants, and then add them to
  the cart again. Their cart updates will happen automatically, without requiring
  a full page refresh.

  Key features:
  - Custom cart method `updateLineByOptions` for variant selection
  - Inline dropdown selectors for each product option in cart
  - Automatic cart updates when options are changed
  - Full TypeScript support with proper type augmentation
notes: []
requirements: |
  - Basic understanding of Hydrogen cart implementation
  - Familiarity with GraphQL and TypeScript
  - Knowledge of React Router actions and forms
  - GraphQL codegen must be run after applying the recipe
ingredients: []
deletedFiles: []
steps:
  - type: PATCH
    step: "1"
    name: Document custom cart methods in the README
    description: Update the README file with custom cart method documentation and an
      implementation guide.
    diffs:
      - file: README.md
        patchFile: README.md.533419.patch
  - type: PATCH
    step: "2"
    name: Let customers change variants directly in the cart
    description: Add variant selector functionality to cart line items for changing
      product options.
    diffs:
      - file: app/components/CartLineItem.tsx
        patchFile: CartLineItem.tsx.7a55bb.patch
  - type: PATCH
    step: "3"
    name: Add updateLineByOptions method to cart context
    description: Extend HydrogenCart context with updateLineByOptions method for
      variant switching.
    diffs:
      - file: app/lib/context.ts
        patchFile: context.ts.46015e.patch
  - type: PATCH
    step: "4"
    name: Query product options for variant selection
    description: Add product options to cart fragments and create
      PRODUCT_VARIANT_QUERY for fetching variants.
    diffs:
      - file: app/lib/fragments.ts
        patchFile: fragments.ts.fc391d.patch
  - type: PATCH
    step: "5"
    name: Handle variant updates in the cart route
    description: Implement the CustomUpdateLineByOptions action handler for
      processing variant changes in cart.
    diffs:
      - file: app/routes/cart.tsx
        patchFile: cart.tsx.536c74.patch
nextSteps: null
llms:
  userQueries: []
  troubleshooting: []
commit: d46c8864aea059cac7dda4871a565f76a04b1495
